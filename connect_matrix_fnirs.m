% measure connectivity matrix on ASL data% going to attempt to replicate results from the Wang, Dong and Niu 2017 paper % on scientific reports % % @ Alexandre Franco - alexandre.franco@nki.rfmh.org% Oct 25rd 2018% First we need to load the data clear all close allp = 0; % to plot or not to plotfilename = '105chRS1.mat'%% Oxy ALL_CM_oxy = [];% looping through subject% Note - removed subject 2 11 17 24 28c_all = [];ii =1;for subj = [1 3    4    5    6    7    8    9   10       12   13   14   15   16      18 19   20   21   22   23      25   26   27     29]%for ii = 1:29# Note for 105 channels, channel 40 of subject 2 is just zeros   if (p)    figure   end     [t, oxy, deoxy] = load_asl_cleandata(filename, subj);  %[t, oxy, deoxy] = load_asl_data(filename, subj);  CM_oxy = corr(oxy); % the is for roughly 6 minutes of data       % Now get only one minute of data   oxy_window = oxy((find(t<60)),:);  CM_oxy_1min = corr(oxy_window);      % Now get only two minutes of data   oxy_window = oxy((find(t<2*60)),:);  CM_oxy_2min = corr(oxy_window);      % Now get only three minutes of data   oxy_window = oxy((find(t<3*60)),:);  CM_oxy_3min = corr(oxy_window);      % Now get only four minutes of data   oxy_window = oxy((find(t<4*60)),:);  CM_oxy_4min = corr(oxy_window);      % Now get only five minutes of data   oxy_window = oxy((find(t<5*60)),:);  CM_oxy_5min = corr(oxy_window);      if (p)    subplot(2,3,1)    imagesc(CM_oxy)    colormap('jet')     subplot(2,3,2)    imagesc(CM_oxy_1min)    colormap('jet')    subplot(2,3,3)    imagesc(CM_oxy_2min)    colormap('jet')    subplot(2,3,4)    imagesc(CM_oxy_3min)    colormap('jet')    subplot(2,3,5)    imagesc(CM_oxy_4min)    colormap('jet')    subplot(2,3,6)    imagesc(CM_oxy_5min)    colormap('jet')    colorbar  endif      % now we can correlate across time (i.e compare CM's from 1 min to 6 min)  %c = [];  c(1,ii) = corr(CM_oxy(:),CM_oxy_1min(:));  c(2,ii) = corr(CM_oxy(:),CM_oxy_2min(:));  c(3,ii) = corr(CM_oxy(:),CM_oxy_3min(:));  c(4,ii) = corr(CM_oxy(:),CM_oxy_4min(:));  c(5,ii) = corr(CM_oxy(:),CM_oxy_5min(:));  c   ii = ii+1;  end % calculate the average and standard deviation c_ave = mean(c,2);c_stdev = std(c,0, 2);figureplot([1:5],c_ave)figureplot([1:5],c_stdev)